#include "dynamixel.h"

unsigned char TxPacket1[] = {0xFF, 0xFF, 0xFD, 0x00, 0x01, 0x06, 0x00, 0x03, 0x40, 0x00, 0x01, 0x00, 0x00};
unsigned char TxPacket2[] = {0xFF, 0xFF, 0xFD, 0x00, 0x01, 0x07, 0x00, 0x02, 0x02, 0x00, 0x04, 0x00, 0x00, 0x00};
unsigned char TxPacket3[] = {0xFF, 0xFF, 0xFD, 0x00, 0x01, 0x09, 0x00, 0x03, 0x74, 0x00, 0x00, 0x02, 0x00, 0x00, 0x00, 0x00};
unsigned char TXRegWrite[] = {0xFF, 0xFF, 0xFD, 0x00, 0x01, 0x09, 0x00, 0x04, 0x68, 0x00, 0xC8, 0x00, 0x00, 0x00, 0x00, 0x00};

void setup()
{
  Serial.begin(115200);
  dx_init();
  Serial.println("Begin!");

  dx_torque_enable(true);

  delay(1000);

  dx_move(512);

  delay(10000);
  
}

void loop()
{
  digitalWrite(8, HIGH);
  Serial1.write(0xFF);
  Serial1.write(0xFF);
  Serial1.write(0xFD);
  Serial1.write(0x00);
  Serial1.write(0x01);
  Serial1.write(0x07);
  Serial1.write(0x00);
  Serial1.write(0x02);
  Serial1.write(0x84);
  Serial1.write(0x00);
  Serial1.write(0x04);
  Serial1.write(0x00);
  Serial1.write(0x1D);
  Serial1.write(0x15);
  Serial1.flush();
  digitalWrite(8, LOW);
  while(Serial1.available()) {
    Serial.println(Serial1.read(), HEX);
  }
  delay(1000);
}
